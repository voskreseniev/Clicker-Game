<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игра с кликами</title>
    <link rel="stylesheet" href="styles_game.css">
</head>
<body>

<div class="top-panel">
    <div class="top-panel-left">
        <span id="usernameLabel">Игрок: </span>
        <span id="username">Гость</span>
    </div>
    <div class="top-panel-right">
        <h2>Монеты: <span id="clickCount">0</span></h2>
    </div>
</div>

<!-- Блок игры -->
<div class="game-block">
    <button onclick="incrementClickCount()">Кликни!</button>
</div>

<!-- Блок улучшений -->
<div class="upgrade-block">
    <h2>Улучшения</h2>
    <p>Автоклики: <span id="autoClickCount">0</span></p>
    <p>Цена автоклика: <span id="autoClickCost">10</span></p>
    <button onclick="buyAutoClick()">Купить автоклик</button>
    <button id="upgradeAutoClickButton" onclick="upgradeAutoClick()" disabled>Улучшить автоклик</button>
</div>

<!-- Блок настроек -->
<div class="settings-block">
    <h2>Настройки</h2>
    <!-- Здесь могут быть настройки -->
</div>

<!-- Дополнительный блок -->
<div class="extra-block">
    <h2>Дополнительно</h2>
    <!-- Здесь может быть дополнительный контент -->
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.23.0/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
<script src="script_game.js"></script>

<script>
    // Проверяем наличие данных в локальном хранилище
    const localData = JSON.parse(localStorage.getItem('gameData')) || {};

    // Если есть локальные данные, используем их
    if (localData.username) {
        document.getElementById('username').textContent = localData.username;
    }

    // Функция для обновления данных в локальном хранилище
    function updateLocalData() {
        const data = {
            username: document.getElementById('username').textContent,
            clickCount: clickCount,
            autoClickCount: autoClickCount,
            autoClickCost: autoClickCost
        };

        localStorage.setItem('gameData', JSON.stringify(data));
    }

    // Функция для обновления данных в таблице при выходе с сайта или перезагрузке страницы
    window.addEventListener('beforeunload', function () {
        axios.put(sheetDBUrl, { data: { username: localData.username, clickCount: clickCount, autoClickCount: autoClickCount } })
            .then(response => {
                console.log('Данные обновлены в таблице:', response.data);
            })
            .catch(error => {
                console.error('Ошибка при обновлении данных в таблице:', error);
                alert('Ошибка при обновлении данных в таблице. Пожалуйста, повторите попытку.');
            });
    });
</script>

</body>
</html>
